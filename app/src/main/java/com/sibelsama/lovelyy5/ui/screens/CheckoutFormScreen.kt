package com.sibelsama.lovelyy5.ui.screens\n\nimport androidx.compose.foundation.layout.*\nimport androidx.compose.foundation.rememberScrollState\nimport androidx.compose.foundation.text.KeyboardOptions\nimport androidx.compose.foundation.verticalScroll\nimport androidx.compose.material3.*\nimport androidx.compose.runtime.*\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.text.input.KeyboardType\nimport androidx.compose.ui.text.font.FontWeight\nimport androidx.compose.ui.tooling.preview.Preview\nimport androidx.compose.ui.unit.dp\nimport com.sibelsama.lovelyy5.ui.theme.LovelyY5APPTheme\n\n// Basic validation functions\nfun validateRut(rut: String): Boolean {\n    val regex = Regex(\"^([0-9]{1,2}\\\\.?[0-9]{3}\\\\.?[0-9]{3}-?[0-9kK])\$\")\n    return regex.matches(rut)\n}\n\nfun validatePhone(phone: String): Boolean {\n    return phone.startsWith(\"+56\") && phone.length == 12 && phone.substring(3).all { it.isDigit() }\n}\n\nfun validateEmail(email: String): Boolean {\n    return \"@\" in email && \".\" in email\n}\n\n@OptIn(ExperimentalMaterial3Api::class)\n@Composable\nfun CheckoutFormScreen(onSubmit: () -> Unit) {\n    var rut by remember { mutableStateOf(\"\") }\n    var isRutError by remember { mutableStateOf(false) }\n    var names by remember { mutableStateOf(\"\") }\n    var lastNames by remember { mutableStateOf(\"\") }\n    var phone by remember { mutableStateOf(\"+56 \") }\n    var isPhoneError by remember { mutableStateOf(false) }\n    var email by remember { mutableStateOf(\"\") }\n    var isEmailError by remember { mutableStateOf(false) }\n    var address by remember { mutableStateOf(\"\") }\n    val regions = listOf(\n        \"I - Región de Tarapacá\", \"II - Región de Antofagasta\", \"III - Región de Atacama\",\n        \"IV - Región de Coquimbo\", \"V - Región de Valparaíso\", \"VI - Región de O'Higgins\",\n        \"VII - Región del Maule\", \"VIII - Región del Biobío\", \"IX - Región de La Araucanía\",\n        \"X - Región de Los Lagos\", \"XI - Región de Aysén\", \"XII - Región de Magallanes\",\n        \"RM - Región Metropolitana\", \"XIV - Región de Los Ríos\", \"XV - Región de Arica y Parinacota\",\n        \"XVI - Región de Ñuble\"\n    )\n    var selectedRegion by remember { mutableStateOf(regions[0]) }\n    var expanded by remember { mutableStateOf(false) }\n\n    fun validateFields(): Boolean {\n        isRutError = !validateRut(rut)\n        isPhoneError = !validatePhone(phone)\n        isEmailError = !validateEmail(email)\n        return !isRutError && !isPhoneError && !isEmailError && names.isNotBlank() && lastNames.isNotBlank() && address.isNotBlank()\n    }\n\n    Scaffold(\n        topBar = { AppHeader() },\n        content = {\n            Column(\n                modifier = Modifier\n                    .padding(it)\n                    .padding(16.dp)\n                    .verticalScroll(rememberScrollState())\n            ) {\n                Text(\"Formulario de Despacho\", style = MaterialTheme.typography.headlineSmall.copy(fontWeight = FontWeight.Bold))\n                Spacer(modifier = Modifier.height(16.dp))\n\n                OutlinedTextField(value = rut, onValueChange = { rut = it }, label = { Text(\"RUT (XX.XXX.XXX-X)\") }, isError = isRutError, modifier = Modifier.fillMaxWidth())\n                OutlinedTextField(value = names, onValueChange = { names = it }, label = { Text(\"Nombres\") }, modifier = Modifier.fillMaxWidth())\n                OutlinedTextField(value = lastNames, onValueChange = { lastNames = it }, label = { Text(\"Apellidos\") }, modifier = Modifier.fillMaxWidth())\n                OutlinedTextField(value = phone, onValueChange = { phone = it }, label = { Text(\"Teléfono (+56 X XXXX XXXX)\") }, isError = isPhoneError, keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Phone), modifier = Modifier.fillMaxWidth())\n                OutlinedTextField(value = email, onValueChange = { email = it }, label = { Text(\"Correo Electrónico\") }, isError = isEmailError, keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Email), modifier = Modifier.fillMaxWidth())\n                OutlinedTextField(value = address, onValueChange = { address = it }, label = { Text(\"Dirección (calle #25, comuna)\") }, modifier = Modifier.fillMaxWidth())\n\n                Box {\n                    OutlinedTextField(\n                        value = selectedRegion,\n                        onValueChange = { },\n                        label = { Text(\"Región\") },\n                        readOnly = true,\n                        trailingIcon = { ExposedDropdownMenuDefaults.TrailingIcon(expanded = expanded) },\n                        modifier = Modifier.fillMaxWidth().clickable { expanded = true }\n                    )\n                    ExposedDropdownMenu(\n                        expanded = expanded,\n                        onDismissRequest = { expanded = false },\n                    ) {\n                        regions.forEach { region ->\n                            DropdownMenuItem(text = { Text(region) }, onClick = { selectedRegion = region; expanded = false })\n                        }\n                    }\n                }\n\n                Spacer(modifier = Modifier.height(24.dp))\n                Button(\n                    onClick = {\n                        if (validateFields()) {\n                            onSubmit()\n                        }\n                    },\n                    modifier = Modifier.fillMaxWidth().height(48.dp)\n                ) {\n                    Text(\"Confirmar Compra\")\n                }\n            }\n        }\n    )\n}\n\n@Preview(showBackground = true)\n@Composable\nfun CheckoutFormScreenPreview() {\n    LovelyY5APPTheme {\n        CheckoutFormScreen(onSubmit = {})\n    }\n}\n